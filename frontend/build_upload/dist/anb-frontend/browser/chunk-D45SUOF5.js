import{a as B,b as R}from"./chunk-PLV6Y62D.js";import"./chunk-XLROA42A.js";import"./chunk-XAZLOLJU.js";import"./chunk-FDVUP3FE.js";import{d as F}from"./chunk-3YQDVD6Z.js";import"./chunk-Q6AJDAHM.js";import{a as W,b as A}from"./chunk-WUV43LHH.js";import{a as Y}from"./chunk-ILB4YYHZ.js";import"./chunk-R3KMJ2P2.js";import{H as k,J as U,L,O as T,P as $,R as D,S as j,T as N}from"./chunk-Z6OHTYI4.js";import{l as I,o as V,p as z}from"./chunk-NHSNNNXZ.js";import{Bb as M,Bc as S,Cc as E,Db as s,Nb as a,Ob as p,Ra as m,Ua as d,Ub as y,Va as O,Vb as v,Wb as u,fa as P,ib as g,na as C,nb as c,oa as x,sb as r,tb as o,ub as _,xc as h,yb as f,yc as b,zc as w}from"./chunk-6K4C2J2M.js";function H(i,e){i&1&&(r(0,"div",9),_(1,"mat-progress-spinner",10),r(2,"p",11),a(3,"Cargando tus videos..."),o()())}function J(i,e){if(i&1){let t=f();r(0,"div",12)(1,"mat-card",13)(2,"mat-card-content")(3,"div",14)(4,"mat-icon",15),a(5,"error_outline"),o(),r(6,"div")(7,"h3"),a(8,"Error al cargar videos"),o(),r(9,"p"),a(10),o(),r(11,"button",16),M("click",function(){C(t);let l=s();return x(l.loadVideos())}),r(12,"mat-icon"),a(13,"refresh"),o(),a(14," Reintentar "),o()()()()()()}if(i&2){let t=s();d(10),p(t.error)}}function K(i,e){if(i&1&&(r(0,"div",30)(1,"mat-icon",31),a(2,"done_all"),o(),r(3,"span",32),a(4),v(5,"date"),o()()),i&2){let t=s().$implicit;d(4),p(u(5,1,t.processed_at,"short"))}}function Q(i,e){if(i&1&&(r(0,"video",41),_(1,"source",42),a(2," Tu navegador no soporta el elemento video. "),o()),i&2){let t=s(2).$implicit,n=s(2);d(),c("src",n.getVideoUrl(t,"processed"),m)}}function X(i,e){if(i&1&&(r(0,"video",41),_(1,"source",42),a(2," Tu navegador no soporta el elemento video. "),o()),i&2){let t=s(2).$implicit,n=s(2);d(),c("src",n.getVideoUrl(t,"original"),m)}}function Z(i,e){if(i&1&&(r(0,"a",43)(1,"button",44)(2,"mat-icon"),a(3,"download"),o(),a(4," Descargar Procesado "),o()()),i&2){let t=s(2).$implicit,n=s(2);c("href",n.processedUrl(t),m)}}function tt(i,e){if(i&1&&(r(0,"a",43)(1,"button",45)(2,"mat-icon"),a(3,"download"),o(),a(4," Descargar Original "),o()()),i&2){let t=s(2).$implicit,n=s(2);c("href",n.originalUrl(t),m)}}function et(i,e){if(i&1&&(r(0,"div",37),g(1,Q,3,1,"video",38)(2,X,3,1,"video",38),r(3,"div",39),g(4,Z,5,1,"a",40)(5,tt,5,1,"a",40),o()()),i&2){let t=s().$implicit,n=s(2);d(),c("ngIf",n.processedUrl(t)),d(),c("ngIf",!n.processedUrl(t)&&n.originalUrl(t)),d(2),c("ngIf",n.processedUrl(t)),d(),c("ngIf",n.originalUrl(t))}}function nt(i,e){if(i&1){let t=f();r(0,"mat-card",19)(1,"div",20)(2,"div",21)(3,"h3",22),a(4),o(),r(5,"div",23)(6,"mat-icon",24),a(7),o(),r(8,"span"),a(9),o()()(),r(10,"div",25)(11,"mat-icon",26),a(12,"how_to_vote"),o(),r(13,"span",27),a(14),o()()(),r(15,"mat-card-content",28)(16,"div",29)(17,"div",30)(18,"mat-icon",31),a(19,"upload"),o(),r(20,"span",32),a(21),v(22,"date"),o()(),g(23,K,6,4,"div",33),o(),g(24,et,6,4,"div",34),o(),r(25,"mat-card-actions",35)(26,"button",36),M("click",function(){let l=C(t).$implicit,G=s(2);return x(G.onDelete(l))}),r(27,"mat-icon"),a(28,"delete"),o(),a(29," Eliminar "),o()()()}if(i&2){let t=e.$implicit,n=s(2);d(4),p(t.title),d(),c("ngClass",n.getStatusClass(t.status)),d(2),p(n.getStatusIcon(t.status)),d(2),p(n.getStatusText(t.status)),d(5),p(t.votes||0),d(7),p(u(22,10,t.uploaded_at,"short")),d(2),c("ngIf",t.processed_at),d(),c("ngIf",n.processedUrl(t)||n.originalUrl(t)),d(2),c("disabled",!n.isDeletable(t))("matTooltip",n.isDeletable(t)?"Eliminar video":"No se puede eliminar (video procesado)")}}function ot(i,e){if(i&1&&(r(0,"div",17),g(1,nt,30,13,"mat-card",18),o()),i&2){let t=s();d(),c("ngForOf",t.videos)}}function it(i,e){i&1&&(r(0,"div",46)(1,"mat-card",47)(2,"mat-card-content")(3,"div",48)(4,"mat-icon",49),a(5,"video_library"),o(),r(6,"h3"),a(7,"No tienes videos subidos"),o(),r(8,"p"),a(9,"\xA1Comienza subiendo tu primer video!"),o(),r(10,"button",50)(11,"mat-icon"),a(12,"add"),o(),a(13," Subir Primer Video "),o()()()()())}var q=class i{constructor(e){this.videoService=e}videos=[];loading=!1;error;ngOnInit(){this.loadVideos()}loadVideos(){this.loading=!0,this.videoService.listMyVideos().subscribe({next:e=>{this.loading=!1,Array.isArray(e)?this.videos=e:e?.data&&Array.isArray(e.data)?this.videos=e.data:this.videos=e?.videos||[]},error:e=>{this.loading=!1,this.error=e?.error?.message||e?.message||"Error cargando videos."}})}processedUrl(e){return this.normalizeUrl(e.processed_url||e.processedUrl)}originalUrl(e){return this.normalizeUrl(e.original_url||e.originalUrl)}videoId(e){return e.video_id||e.id}normalizeUrl(e){if(!e)return null;let t=String(e);if(t.startsWith("http://")||t.startsWith("https://"))return t;if(t.startsWith("uploads/"))return`/${t}`;let n=z.apiUrl?.replace(/\/$/,"");return n?`${n}${t.startsWith("/")?"":"/"}${t}`:t}getVideoUrl(e,t){let n=t==="processed"?this.processedUrl(e):this.originalUrl(e);return n?n.startsWith("/uploads")||n.startsWith("uploads")?n.startsWith("/")?n:"/"+n:n:null}onDelete(e){let t=this.videoId(e);confirm(`\xBFEliminar video "${e.title}"? Esta acci\xF3n no se puede deshacer.`)&&this.videoService.deleteVideo(t).subscribe({next:l=>{this.loadVideos()},error:l=>{l?.status===400?this.error=l?.error?.error||"El video no puede eliminarse por su estado (procesado/publicado).":l?.status===403?this.error="No tienes permisos para eliminar este video.":l?.status===404?this.error="Video no encontrado.":this.error=l?.error?.message||l?.message||"Error eliminando el video."}})}isDeletable(e){return(e?.status||"").toString().trim().toLowerCase()==="uploaded"}getStatusClass(e){let t=(e||"").toLowerCase();return t==="processed"?"status-processed":t==="processing"?"status-processing":"status-uploaded"}getStatusIcon(e){let t=(e||"").toLowerCase();return t==="processed"?"check_circle":t==="processing"?"autorenew":"upload"}getStatusText(e){let t=(e||"").toLowerCase();return t==="processed"?"Procesado":t==="processing"?"Procesando":"Subido"}static \u0275fac=function(t){return new(t||i)(O(Y))};static \u0275cmp=P({type:i,selectors:[["app-list-videos"]],standalone:!0,features:[y],decls:11,vars:4,consts:[[1,"videos-container"],[1,"header-section"],[1,"title-container"],[1,"header-icon"],[1,"page-title"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","videos-grid",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"loading-container"],["diameter","40","mode","indeterminate","color","primary"],[1,"loading-text"],[1,"error-container"],[1,"error-card"],[1,"error-content"],[1,"error-icon"],["mat-stroked-button","","color","primary",3,"click"],[1,"videos-grid"],["class","video-card",4,"ngFor","ngForOf"],[1,"video-card"],[1,"card-header"],[1,"video-info"],[1,"video-title"],[1,"status-badge",3,"ngClass"],[1,"status-icon"],[1,"votes-display"],[1,"votes-icon"],[1,"votes-count"],[1,"card-content"],[1,"metadata"],[1,"meta-item"],[1,"meta-icon"],[1,"meta-text"],["class","meta-item",4,"ngIf"],["class","video-player-section",4,"ngIf"],[1,"card-actions"],["mat-button","","color","warn",1,"action-btn","delete-btn",3,"click","disabled","matTooltip"],[1,"video-player-section"],["controls","","class","video-player","preload","none","loading","lazy",4,"ngIf"],[1,"download-links"],["target","_blank","download","",3,"href",4,"ngIf"],["controls","","preload","none","loading","lazy",1,"video-player"],["type","video/mp4",3,"src"],["target","_blank","download","",3,"href"],["mat-stroked-button","","color","accent",1,"download-btn"],["mat-stroked-button","","color","primary",1,"download-btn"],[1,"empty-state"],[1,"empty-card"],[1,"empty-content"],[1,"empty-icon"],["mat-flat-button","","color","primary","routerLink","/dashboard/upload",1,"upload-btn-empty"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),a(4,"video_library"),o(),r(5,"h2",4),a(6,"Mis Videos"),o()()(),g(7,H,4,0,"div",5)(8,J,15,1,"div",6)(9,ot,2,1,"div",7)(10,it,14,0,"div",8),o()),t&2&&(d(7),c("ngIf",n.loading),d(),c("ngIf",n.error&&!n.loading),d(),c("ngIf",!n.loading&&!n.error&&n.videos.length>0),d(),c("ngIf",!n.loading&&!n.error&&n.videos.length===0))},dependencies:[E,h,b,w,S,F,T,k,L,U,D,$,N,j,A,W,R,B,V,I],styles:[".videos-container[_ngcontent-%COMP%]{max-width:1200px;margin:24px auto;padding:0 16px}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;padding:20px 0;border-bottom:2px solid #e0e0e0}.header-section[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.header-section[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:32px;color:#1976d2}.header-section[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:600;color:#333}.header-section[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;border-radius:8px;font-weight:500}.header-section[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:64px 24px}.loading-container[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{margin-top:16px;color:#666;font-size:16px}.error-container[_ngcontent-%COMP%]{margin-bottom:24px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]{border-left:4px solid #f44336;border-radius:8px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{color:#f44336;font-size:32px;margin-top:4px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#f44336;font-size:18px}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px;color:#666}.error-container[_ngcontent-%COMP%]   .error-card[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.videos-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:24px}.video-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow:hidden;transition:all .3s ease}.video-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 24px #00000026;transform:translateY(-2px)}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding:20px;display:flex;justify-content:space-between;align-items:flex-start}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]{flex:1}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]   .video-title[_ngcontent-%COMP%]{margin:0 0 12px;font-size:18px;font-weight:600;color:#333;line-height:1.3}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:500}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:16px}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]   .status-badge.status-uploaded[_ngcontent-%COMP%]{background:#fff3e0;color:#ff9800;border:1px solid #ffcc02}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]   .status-badge.status-processed[_ngcontent-%COMP%]{background:#e8f5e8;color:#4caf50;border:1px solid #81c784}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .video-info[_ngcontent-%COMP%]   .status-badge.status-processing[_ngcontent-%COMP%]{background:#e3f2fd;color:#2196f3;border:1px solid #64b5f6}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .votes-display[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .votes-display[_ngcontent-%COMP%]   .votes-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:24px}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .votes-display[_ngcontent-%COMP%]   .votes-count[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#1976d2}.video-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:20px}.video-card[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:20px}.video-card[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.video-card[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .meta-icon[_ngcontent-%COMP%]{color:#666;font-size:18px}.video-card[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .meta-text[_ngcontent-%COMP%]{color:#666;font-size:14px}.video-card[_ngcontent-%COMP%]   .video-player-section[_ngcontent-%COMP%]{margin:16px 0}.video-card[_ngcontent-%COMP%]   .video-player-section[_ngcontent-%COMP%]   .video-player[_ngcontent-%COMP%]{width:100%;max-width:100%;height:auto;border-radius:8px;background:#000;margin-bottom:12px}.video-card[_ngcontent-%COMP%]   .video-player-section[_ngcontent-%COMP%]   .download-links[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.video-card[_ngcontent-%COMP%]   .video-player-section[_ngcontent-%COMP%]   .download-links[_ngcontent-%COMP%]   .download-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:6px;font-size:13px}.video-card[_ngcontent-%COMP%]   .video-player-section[_ngcontent-%COMP%]   .download-links[_ngcontent-%COMP%]   .download-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px}.video-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{background:#fafafa;padding:16px 20px;display:flex;justify-content:flex-end}.video-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:6px;font-weight:500}.video-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.video-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .action-btn.delete-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]{border-radius:12px}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]{text-align:center;padding:64px 32px}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:72px;color:#ccc;margin-bottom:24px}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;font-size:24px;color:#666}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 32px;color:#999;font-size:16px}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   .upload-btn-empty[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 24px;border-radius:8px;font-weight:500}.empty-state[_ngcontent-%COMP%]   .empty-card[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   .upload-btn-empty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}@media (max-width: 768px){.videos-container[_ngcontent-%COMP%]{margin:16px auto;padding:0 12px}.header-section[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:stretch}.header-section[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]{justify-content:center}.videos-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.video-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .votes-display[_ngcontent-%COMP%]{flex-direction:row;align-self:flex-start}.video-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.video-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}.download-links[_ngcontent-%COMP%]{flex-direction:column}.download-links[_ngcontent-%COMP%]   .download-btn[_ngcontent-%COMP%]{justify-content:center}}"]})};export{q as ListVideosComponent};
