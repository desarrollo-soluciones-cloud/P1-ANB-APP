import './polyfills.server.mjs';
import{a as s,b as m}from"./chunk-2QCJARLM.mjs";import{Mc as o,Q as l,T as p,Y as a,g as c,za as u}from"./chunk-ENQYR2OO.mjs";var h={production:!0,apiUrl:""};var g=class n{constructor(t,e){this.http=t;this.platformId=e;this.checkAuthStatus()}apiUrl=h.apiUrl;currentUserSubject=new c(null);currentUser$=this.currentUserSubject.asObservable();checkAuthStatus(){if(o(this.platformId)){let t=localStorage.getItem("token"),e=localStorage.getItem("currentUser");if(t&&e)try{let r=JSON.parse(e);this.currentUserSubject.next(r)}catch{this.logout()}}}login(t){let e={email:t.email||t.username,password:t.password};return this.http.post(`${this.apiUrl}/api/v1/auth/login`,e).pipe(l(r=>{let i=r?.access_token||r?.AccessToken||r?.accessToken||r?.token||r?.data?.token;i&&o(this.platformId)&&(localStorage.setItem("token",i),localStorage.setItem("currentUser",JSON.stringify({email:e.email})),this.currentUserSubject.next({email:e.email}))}))}register(t){let e={first_name:t.first_name,last_name:t.last_name,email:t.email,password:t.password,password2:t.password2,city:t.city,country:t.country};return this.http.post(`${this.apiUrl}/api/v1/auth/signup`,e)}logout(){o(this.platformId)&&(localStorage.removeItem("token"),localStorage.removeItem("currentUser")),this.currentUserSubject.next(null)}getToken(){return o(this.platformId)?localStorage.getItem("token"):null}isLoggedIn(){return!!this.getToken()}getCurrentUser(){return this.currentUserSubject.value}getAuthHeaders(){let t=this.getToken();return new s({Authorization:t?`Bearer ${t}`:"","Content-Type":"application/json"})}getAuthHeadersForFormData(){let t=this.getToken();return new s({Authorization:t?`Bearer ${t}`:""})}static \u0275fac=function(e){return new(e||n)(a(m),a(u))};static \u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"})};export{h as a,g as b};
